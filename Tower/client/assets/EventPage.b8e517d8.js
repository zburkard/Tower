import{i as f,l,A as m,_ as x,j as I,u as E,o as T,c as u,P as d,k as p,a as c,b as t,t as _,d as y,n as S,F as g,r as w,w as j,m as B,v as A,q as C,e as a,p as M,g as P}from"./index.47bd122a.js";import{t as b}from"./TicketsService.08c78bd1.js";class H{async getCommentsByEventId(s){const r=await f.get(`api/events/${s}/comments`);l.log("[Got Comments]",r.data),m.comments=r.data}async createComment(s){const r=await f.post("api/comments",s);l.log("[Posted Comment]",r.data),m.comments.push(r.data)}async removeComment(s){const r=await f.delete("api/comments/"+s);l.log("[Removed Comment]",r.data);let e=m.comments.findIndex(h=>h.id==id);e>=0&&m.comments.splice(e,1)}}const k=new H;const F={setup(){const i=I({}),s=E();async function r(){try{await p.getEventById(s.params.eventId)}catch(o){l.error(o),d.error(o.message)}}async function e(){try{await b.getTicketHolders(s.params.eventId)}catch(o){l.error(o),d.error(o)}}async function h(){try{await k.getCommentsByEventId(s.params.eventId)}catch(o){l.error(o),d.error(o)}}return T(()=>{r(),e(),h()}),{editable:i,event:u(()=>m.activeEvent),ticketHolders:u(()=>m.tickets),comments:u(()=>m.comments),account:u(()=>m.account),foundMe:u(()=>m.tickets.find(o=>o.accountId==m.account.id)),async cancelEvent(o){try{await d.confirm("Are you sure? You will have to make a new event"),await p.cancelEvent(o)}catch(n){l.error(n),d.error(n.message)}r()},async buyTicket(){try{await b.buyTicket({eventId:s.params.eventId})}catch(o){l.error(o),d.error(o.message)}},async removeTicket(o){try{await d.confirm("Are you sure?")&&await b.removeTicket(o)}catch(n){l.error(n),d.error(n)}},async createComment(){try{i.value.eventId=s.params.eventId,await k.createComment(i.value),i.value={}}catch(o){l.error(o),d.error(o)}},async removeComment(o){try{await d.confirm(),await k.removeComment(o)}catch{}h()}}}},v=i=>(M("data-v-6835de8b"),i=i(),P(),i),L={key:0,class:"container-fluid"},R={class:"col-10 mx-3"},V={class:"mt-4"},D={class:"mt-4"},N={class:"mt-4 category"},G={class:"mt-4"},q={class:"mt-4"},z={key:0,class:"row text-danger text-center"},O=v(()=>t("h3",null,"Event Has Been Canceled",-1)),U=[O],W={key:1,class:"row justify-content-end m-3 align-items-center"},Y={class:"col-2 d-flex justify-content-around dark rounded"},J=v(()=>t("h5",{class:"m-3"},"Tickets Left:",-1)),K={key:0,class:"text-danger m-3"},Q={key:1,class:"m-3"},X={key:0,disabled:"",class:"col-2 p-2 btn btn-danger mx-3"},Z=v(()=>t("h5",{class:"fw-bold"},"Event is Sold Out\u26A0",-1)),$=[Z],ee=v(()=>t("h5",{class:"fw-bold"},"Get A Ticket \u{1F39F}",-1)),te=[ee],oe=v(()=>t("h5",{class:"fw-bold"},"Remove Ticket \u{1F39F}",-1)),se=[oe],ne={class:"col-1 p-3 mt-3 text-end"},ce=C("Cancel Event "),ae=v(()=>t("i",{class:"mdi mdi-cancel"},null,-1)),re=[ce,ae],ie={key:1,class:"btn btn-danger fw-bold fs-4",disabled:""},de={class:"container"},le=v(()=>t("div",{class:"row justify-content-center mt-5"},[t("div",{class:"col-10"},[t("h5",{class:"cover"},"See Who Is Attending:")])],-1)),me={class:"row justify-content-center"},_e={class:"col-10 d-flex dark rounded-pill"},ve={class:"m-2"},he=["src","title"],ue={class:"container mt-3"},ye={class:"row justify-content-center"},fe={key:0,class:"col-8 dark p-3 rounded-top"},ge={class:"form-group"},be={for:"exampleFormControlTextarea1",class:"text-light fs-4"},ke=C("Leave A Comment"),pe=["src"],we=v(()=>t("button",{type:"submit",class:"btn btn-success mt-3"},"Post Comment",-1)),Ce={class:"row justify-content-center m-3"},xe=v(()=>t("h5",{class:"text-light text-center"},"See what people are saying...",-1)),Ie={class:"col-8 dark rounded"},Ee={class:"row justify-content-center"},Te={class:"col-6 d-flex align-items-center"},Se=["src"],je={class:"text-light"},Be={class:"col-6 d-flex justify-content-between align-items-center"},Ae={class:"text-dark bg-light p-1 rounded mt-3"},Me=["onClick"];function Pe(i,s,r,e,h,o){return a(),c(g,null,[e.event?(a(),c("div",L,[t("div",{style:S(`background-image: url(${e.event.coverImg})`),class:"row mt-3 rounded elevation-4 cover"},[t("div",R,[t("h2",V,_(e.event.name),1),t("h3",D,"Starts: "+_(e.event.startDate),1),t("h4",N,_(e.event.type),1),t("h4",G,"Location: "+_(e.event.location),1),t("p",q,_(e.event.description),1),e.event.isCanceled?(a(),c("div",z,U)):(a(),c("div",W,[t("div",Y,[J,e.event.capacity<=20?(a(),c("h5",K,_(e.event.capacity),1)):(a(),c("h5",Q,_(e.event.capacity),1))]),e.event.capacity==0?(a(),c("button",X,$)):e.account.id&&!e.foundMe?(a(),c("button",{key:1,onClick:s[0]||(s[0]=n=>e.buyTicket()),class:"col-2 p-2 btn btn-success mx-3"},te)):e.account.id?(a(),c("button",{key:2,onClick:s[1]||(s[1]=n=>e.removeTicket(e.foundMe.id)),class:"col-2 p-2 btn btn-danger mx-3"},se)):y("",!0)]))]),t("div",ne,[e.account.id==e.event.creatorId&&e.event.isCanceled==!1?(a(),c("button",{key:0,onClick:s[2]||(s[2]=n=>e.cancelEvent(e.event.id)),class:"btn btn-danger"},re)):e.event.isCanceled==!0?(a(),c("button",ie,"Event Canceled")):y("",!0)])],4)])):y("",!0),t("div",de,[le,t("div",me,[t("div",_e,[(a(!0),c(g,null,w(e.ticketHolders,n=>(a(),c("div",ve,[t("img",{src:n.profile.picture,alt:"",title:n.profile.name,class:"picture rounded-circle elevation-4"},null,8,he)]))),256))])])]),t("div",ue,[t("div",ye,[e.account.id?(a(),c("div",fe,[t("form",{onSubmit:s[4]||(s[4]=j(n=>e.createComment(),["prevent"]))},[t("div",ge,[t("label",be,[ke,t("img",{src:e.account.picture,class:"picture rounded-circle elevation-4 m-3",alt:""},null,8,pe)]),B(t("textarea",{"onUpdate:modelValue":s[3]||(s[3]=n=>e.editable.body=n),placeholder:"Type comment here...",class:"form-control",id:"exampleFormControlTextarea1",rows:"3"},null,512),[[A,e.editable.body]])]),we],32)])):y("",!0)]),t("div",Ce,[xe,(a(!0),c(g,null,w(e.comments,n=>(a(),c("div",Ie,[t("div",Ee,[t("div",Te,[t("img",{src:n.creator.picture,class:"picture rounded-circle elevation-4 m-3",alt:""},null,8,Se),t("h4",je,_(n.creator.name),1)]),t("div",Be,[t("p",Ae,_(n.body),1),e.account.id==n.creatorId?(a(),c("button",{key:0,class:"btn btn-danger",onClick:He=>e.removeComment(n.id)},"Remove Comment",8,Me)):y("",!0)])])]))),256))])])],64)}const Re=x(F,[["render",Pe],["__scopeId","data-v-6835de8b"]]);export{Re as default};
